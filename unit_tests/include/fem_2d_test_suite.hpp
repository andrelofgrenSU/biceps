#pragma once
#include <fem_2d.hpp>
#include <Eigen/Dense>
#define BOOST_TEST_MAIN boost_test_message
#include <boost/test/unit_test.hpp>

static Eigen::MatrixX<FloatType> points_tri_deg_1_ref = (
	Eigen::MatrixX<FloatType>(3, 2) <<
	0.0, 0.0,
	1.0, 0.0,
	0.0, 1.0
).finished();

static Eigen::MatrixX<FloatType> points_tri_deg_2_ref = (
	Eigen::MatrixX<FloatType>(6, 2) <<
	0.0, 0.0,
	0.5, 0.0,
	1.0, 0.0,
	0.5, 0.5,
	0.0, 1.0,
	0.0, 0.5
).finished();

static Eigen::MatrixX<FloatType> points_quad_deg_1_ref = (
	Eigen::MatrixX<FloatType>(4, 2) <<
	0.0, 0.0,
	1.0, 0.0,
	1.0, 1.0,
	0.0, 1.0
).finished();

static Eigen::MatrixX<FloatType> points_quad_deg_2_ref = (
	Eigen::MatrixX<FloatType>(9, 2) <<
	0.0, 0.0,
	0.5, 0.0,
	1.0, 0.0,
	1.0, 0.5,
	1.0, 1.0,
	0.5, 1.0,
	0.0, 1.0,
	0.0, 0.5,
	0.5, 0.5
).finished();

static Eigen::MatrixX<FloatType> M_1x1_ref = (
	Eigen::MatrixX<FloatType>(4, 4) <<
	0.194444444444444, 0.0833333333333333, 0.0972222222222222, 0.0416666666666667,
	0.0833333333333333,  0.138888888888889, 0.0416666666666667, 0.0694444444444444,
	0.0972222222222222, 0.0416666666666667,  0.194444444444444, 0.0833333333333333,
	0.0416666666666667, 0.0694444444444444, 0.0833333333333333,  0.138888888888889
).finished();

static Eigen::MatrixX<FloatType> A_1x1_ref = (
	Eigen::MatrixX<FloatType>(4, 4) <<
	 0.924196240746594, -0.348392481493187,  0.0758037592534063, -0.651607518506813,
	-0.348392481493187,  0.696784962986375, -0.151607518506813, -0.196784962986375,
	0.0758037592534063, -0.151607518506813,  0.424196240746594, -0.348392481493187,
	-0.651607518506813, -0.196784962986375, -0.348392481493187,  1.19678496298637
).finished();

static Eigen::MatrixX<FloatType> A_xx_1x1_ref = (
	Eigen::MatrixX<FloatType>(4, 4) <<
	0.731049060186648, -0.462098120373297,  0.268950939813352, -0.537901879626703,
	-0.462098120373297,  0.424196240746594, -0.037901879626703,  0.075803759253406,
	0.268950939813352, -0.037901879626703,  0.231049060186648, -0.462098120373297,
	-0.537901879626703,  0.075803759253406, -0.462098120373297,  0.924196240746594
).finished();

static Eigen::MatrixX<FloatType> A_zz_1x1_ref = (
	Eigen::MatrixX<FloatType>(4, 4) <<
	 0.193147180559945,  0.113705638880109, -0.193147180559945, -0.113705638880109,
	 0.113705638880109,  0.272588722239781, -0.113705638880109, -0.272588722239781,
	-0.193147180559945, -0.113705638880109,  0.193147180559945,  0.113705638880109,
	-0.113705638880109, -0.272588722239781,  0.113705638880109,  0.272588722239781
).finished();
